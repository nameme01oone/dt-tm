@font-face {
  font-family: APPLE II;
  src: url(font/TM-font.ttf);
}

body {
  font-family: 'APPLE II', monospace;
  background: #000;
  margin: 0;
  overflow: hidden;
  height: 100vh;
  color: #0f0;
}

/* Center everything */
.container {
  height: 100vh;
  width: 100vw;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Text styling */
.text {
  font-weight: 100;
  font-size: 28px;
  color: #0f0;
  text-shadow: 0 0 8px #0f0;
}

.dud {
  color: #757575;
}

/* Loading screen */
.loading {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  color: #0f0;
  font-family: 'APPLE II', monospace;
  font-size: 24px;
  text-shadow: 0 0 10px #0f0;
  z-index: 1000;
  animation: flicker 0.1s infinite;
}

.loading-text {
  animation: blink 0.4s step-start infinite;
}

@keyframes blink {
  50% { opacity: 0; }
}

.fade-out {
  opacity: 0;
  transition: opacity 1s ease-out;
}

.hidden {
  display: none;
}

/* CRT effect flicker + scanlines */
.crt {
  position: relative;
  filter: contrast(1.2) brightness(1.05);
  animation: flicker 0.15s infinite;
}

.crt::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: repeating-linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0.1),
    rgba(0, 0, 0, 0.1) 1px,
    transparent 2px,
    transparent 3px
  );
  pointer-events: none;
  z-index: 10;
}

@keyframes flicker {
  0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
    opacity: 1;
  }
  20%, 24%, 55% {
    opacity: 0.8;
  }
}

/* Threat Detected: blink twice effect */
.blink-twice {
  animation: blinkTwice 500ms linear 1 both;
}

@keyframes blinkTwice {
  0% { opacity: 1; }
  20% { opacity: 0; }
  35% { opacity: 1; }
  55% { opacity: 0; }
  70% { opacity: 1; }
  100% { opacity: 1; }
}

.hack-overlay.flash {
  background: rgba(255,255,255,0.95);
  animation: overlayFlashThrice 600ms linear 1 both;
}

@keyframes overlayFlashTwice {
  0% { opacity: 0; }
  20% { opacity: 1; }
  35% { opacity: 0; }
  55% { opacity: 1; }
  70% { opacity: 0; }
  100% { opacity: 0; }
}

@keyframes overlayFlashThrice {
  0% { opacity: 0; }
  15% { opacity: 1; }
  30% { opacity: 0; }
  45% { opacity: 1; }
  60% { opacity: 0; }
  75% { opacity: 1; }
  100% { opacity: 0; }
}

.hack-overlay.flash::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: radial-gradient(rgba(255, 255, 255, 0.12) 1px, transparent 1px);
  background-size: 3px 3px;
  mix-blend-mode: overlay;
  opacity: 0;
  animation: grain 600ms steps(10) 1 both;
}

.hack-overlay.flash::after {
  animation: scanJitter 600ms steps(6) 1 both;
}

.rgb-split {
  animation: rgbShift 600ms steps(6) 1 both;
}

/* Hack overlay base styling */
.hack-overlay {
  position: fixed;
  inset: 0;
  z-index: 900;
  pointer-events: none;
  opacity: 0;
  background: radial-gradient(closest-corner at 50% 50%, rgba(255,255,255,0.18), rgba(255,255,255,0) 60%),
              radial-gradient(farthest-side at 50% 50%, rgba(255,255,255,0.08), rgba(255,255,255,0) 75%);
  box-shadow: inset 0 0 120px rgba(255,255,255,0.25);
  backdrop-filter: brightness(1.08) contrast(1.06) saturate(1.05) blur(0.6px);
  will-change: opacity, transform, filter;
}

.hack-overlay::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.03) 0px,
    rgba(255,255,255,0.03) 1px,
    transparent 2px,
    transparent 3px
  );
  mix-blend-mode: overlay;
  opacity: 0;
}

@keyframes grain {
  0% { opacity: 0.35; transform: translate3d(0,0,0); }
  15% { opacity: 0.6; transform: translate3d(-1px,0,0); }
  30% { opacity: 0.45; transform: translate3d(1px,0,0); }
  45% { opacity: 0.7; transform: translate3d(0,1px,0); }
  60% { opacity: 0.5; transform: translate3d(0,-1px,0); }
  75% { opacity: 0.8; transform: translate3d(0,0,0); }
  100% { opacity: 0; transform: translate3d(0,0,0); }
}

@keyframes scanJitter {
  0%, 10% { opacity: 0.25; transform: translate3d(0, -1px, 0); }
  20%, 30% { opacity: 0.4; transform: translate3d(0, 1px, 0); }
  40%, 50% { opacity: 0.35; transform: translate3d(0, -1px, 0); }
  60%, 70% { opacity: 0.5; transform: translate3d(0, 1px, 0); }
  80% { opacity: 0.3; transform: translate3d(0, 0, 0); }
  100% { opacity: 0; transform: translate3d(0, 0, 0); }
}

/* RGB split base styling */
.rgb-split {
  position: fixed;
  inset: 0;
  z-index: 905;
  pointer-events: none;
  mix-blend-mode: screen;
  background:
    linear-gradient(to right, rgba(255,0,0,0.18), rgba(255,0,0,0)) 0 0 / 100% 100% no-repeat,
    linear-gradient(to left, rgba(0,255,255,0.18), rgba(0,255,255,0)) 0 0 / 100% 100% no-repeat;
  filter: blur(0.8px);
  will-change: transform, opacity, filter;
}

@keyframes rgbShift {
  0% { transform: translate3d(0, 0, 0); opacity: 0.8; }
  25% { transform: translate3d(-2px, 0, 0); opacity: 1; }
  50% { transform: translate3d(2px, 0, 0); opacity: 0.95; }
  75% { transform: translate3d(-1px, 0, 0); opacity: 0.9; }
  100% { transform: translate3d(0, 0, 0); opacity: 0; }
}

/* Mirror ghost styling */
.mirror-ghost {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  color: #0f0;
  pointer-events: none;
  z-index: 910;
  mix-blend-mode: multiply;
  text-shadow:
    2px 0 0 rgba(255, 0, 0, 0.6),
    -2px 0 0 rgba(0, 255, 255, 0.6),
    0 0 2px #000;
  opacity: 0;
}

.mirror-ghost.play {
  animation: ghostFlick 600ms ease-out 1 both;
}

@keyframes ghostFlick {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
  10% { opacity: 0.9; transform: translate(calc(-50% - 2px), calc(-50% - 1px)) scale(1.02); }
  40% { opacity: 0.7; transform: translate(calc(-50% + 3px), calc(-50% + 2px)) scale(0.98); }
  70% { opacity: 0.5; transform: translate(calc(-50% - 2px), calc(-50% + 1px)) scale(1.01); }
  100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
}

/* One-time modern monitor overlay */
.monitor-boost {
  filter: contrast(1.18) brightness(1.1) saturate(1.1);
}

.modern-monitor {
  position: fixed;
  inset: 0;
  z-index: 1000;
  pointer-events: none;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05), rgba(255,255,255,0) 60%);
  backdrop-filter: contrast(1.2) saturate(1.15) brightness(1.1) blur(1px);
  animation: monitorPulse 600ms ease-out 1 both;
}

.reticle {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 80px;
  height: 80px;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255,255,255,0.25);
  box-shadow: 0 0 12px rgba(255,255,255,0.15);
}

.monitor-corner {
  position: absolute;
  width: 20px;
  height: 20px;
  border: 1px solid rgba(255,255,255,0.2);
}

.monitor-corner.tl { top: 10px; left: 10px; }
.monitor-corner.tr { top: 10px; right: 10px; }
.monitor-corner.bl { bottom: 10px; left: 10px; }
.monitor-corner.br { bottom: 10px; right: 10px; }

.text.monitor-sharp {
  text-shadow: 0 0 2px #0f0, 0 0 6px rgba(0,255,0,0.4);
  filter: contrast(1.15);
}

@keyframes monitorPulse {
  0% { opacity: 0; }
  20% { opacity: 0.4; }
  40% { opacity: 0.6; }
  60% { opacity: 0.5; }
  80% { opacity: 0.3; }
  100% { opacity: 0; }
}

/* Rapid blink loop for Threat Detected */
.blink-rapid {
  animation: blinkTwice 1000ms linear infinite;
}

/* RUN overlay spam */
.run-overlay {
  position: fixed;
  inset: 0;
  z-index: 1200; /* ensure above loading(1000), hack(900), monitor(1000) */
  pointer-events: none;
  display: flex;
  flex-wrap: wrap;
  align-content: stretch;
  align-items: stretch;
  background: transparent;
}

.run-item {
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'APPLE II', monospace;
  color: #0f0;
  text-shadow: 0 0 8px #0f0, 0 0 18px rgba(0,255,0,0.8);
  opacity: 1;
  animation: runJitter 600ms steps(6) infinite alternate;
}

@keyframes runJitter {
  0% { transform: translate3d(0, 0, 0); opacity: 0.95; }
  25% { transform: translate3d(-1px, 0, 0); opacity: 1; }
  50% { transform: translate3d(1px, 0, 0); opacity: 0.9; }
  75% { transform: translate3d(0, 1px, 0); opacity: 0.92; }
  100% { transform: translate3d(0, -1px, 0); opacity: 0.96; }
}

/* STOP overlay X-shaped typing/stretch effect */
.stop-overlay {
  position: fixed;
  inset: 0;
  z-index: 1300; /* above run(1200) */
  pointer-events: none;
  background: transparent;
}

.stop-letter {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate3d(-50%, -50%, 0) scale(0.9);
  color: #0f0;
  font-family: 'APPLE II', monospace;
  text-shadow: 0 0 8px #0f0, 0 0 18px rgba(0,255,0,0.8);
  opacity: 0;
  will-change: transform, opacity, letter-spacing;
}

.stop-letter.play {
  animation: stopTypeStretch 1200ms ease-out forwards;
}

@keyframes stopTypeStretch {
  0% { opacity: 0; transform: translate3d(-50%, -50%, 0) scale(0.8); filter: blur(0.6px); }
  10% { opacity: 1; transform: translate3d(-50%, -50%, 0) scale(1.0); }
  55% { transform: translate3d(-50%, -50%, 0) scale(1.6); letter-spacing: 1px; }
  100% { opacity: 1; transform: translate3d(-50%, -50%, 0) scale(2.1); letter-spacing: 2px; }
}

/* Typing ghost per-letter overlay */
.type-ghost {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 915;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0;
  filter: saturate(1.15) contrast(1.06);
  text-shadow: 0 0 10px #0f0, 0 0 24px rgba(0,255,0,0.95), 2px 0 0 rgba(255, 0, 0, 0.35), -2px 0 0 rgba(0, 255, 255, 0.35);
}

.type-ghost.play {
  animation: typeGhost 680ms ease-out forwards;
}

@keyframes typeGhost {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.96); filter: blur(0.4px); }
  12% { opacity: 1; transform: translate(calc(-50% - 1px), calc(-50% - 1px)) scale(1.0); }
  45% { opacity: 0.8; transform: translate(calc(-50% + 2px), calc(-50% + 1px)) scale(1.02); }
  75% { opacity: 0.6; transform: translate(calc(-50% - 2px), calc(-50%)) scale(1.0); }
  100% { opacity: 0; transform: translate(-50%, -50%) scale(1.0); }
}
.type-ghost::before,
.type-ghost::after {
  content: attr(data-text);
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
  opacity: 0.65;
  text-shadow: none;
  filter: blur(0.2px);
}
.type-ghost::before {
  color: rgba(255, 0, 0, 0.42);
  animation: ghostRGBShift 680ms ease-out forwards;
}
.type-ghost::after {
  color: rgba(0, 255, 255, 0.42);
  animation: ghostRGBShift 680ms ease-out forwards reverse;
}

@keyframes ghostRGBShift {
  0% { transform: translate(0, 0); opacity: 0.8; }
  25% { transform: translate(-1px, 0.5px); opacity: 0.9; }
  50% { transform: translate(1px, -0.5px); opacity: 0.85; }
  75% { transform: translate(-0.5px, 0px); opacity: 0.75; }
  100% { transform: translate(0, 0); opacity: 0; }
}

/* One-time blink utility */
.blink-once {
  animation: blinkOnce 320ms linear 1 both;
}
@keyframes blinkOnce {
  0% { opacity: 1; }
  40% { opacity: 0; }
  100% { opacity: 1; }
}

/* STOP full-screen expand overlay */
.stop-fullscreen {
  position: fixed;
  inset: 0;
  z-index: 1320;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
}
.stop-full-word {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  font-family: 'APPLE II', monospace;
  color: #0f0;
  text-shadow: 0 0 10px #0f0, 0 0 24px rgba(0,255,0,0.95), 0 0 40px rgba(0,255,0,0.95);
  opacity: 0;
  mix-blend-mode: screen;
  will-change: transform, opacity, letter-spacing, filter;
}
.stop-full-word.play {
  animation: stopFullExpand 1000ms ease-out 1 forwards;
}
@keyframes stopFullExpand {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); filter: blur(0.5px); letter-spacing: 0; }
  12% { opacity: 1; transform: translate(-50%, -50%) scale(1.0); filter: blur(0); }
  70% { opacity: 1; transform: translate(-50%, -50%) scale(6.0); letter-spacing: 1px; }
  100% { opacity: 1; transform: translate(-50%, -50%) scale(10.0); letter-spacing: 2px; }
}

/* STOP white flash base */
.stop-white-flash {
  position: fixed;
  inset: 0;
  z-index: 1315; /* behind stop-fullscreen (1320) */
  pointer-events: none;
  background: #fff;
  opacity: 0;
  mix-blend-mode: screen;
}
.stop-white-flash.play {
  animation: stopWhiteFlash 180ms ease-out 1 forwards;
}
@keyframes stopWhiteFlash {
  0% { opacity: 0; }
  40% { opacity: 0.65; }
  100% { opacity: 0; }
}

/* Stronger warning expand with mid-phase blur */
@keyframes stopFullExpandWarn {
  0% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); filter: blur(1px); letter-spacing: 0; }
  12% { opacity: 1; transform: translate(-50%, -50%) scale(1.0); filter: blur(0.2px); }
  40% { filter: blur(0.6px); }
  70% { opacity: 1; transform: translate(-50%, -50%) scale(6.0); letter-spacing: 1px; filter: blur(0.3px); }
  100% { opacity: 1; transform: translate(-50%, -50%) scale(10.0); letter-spacing: 2px; filter: blur(0.2px); }
}

/* Pulsing glow for STOP word */
@keyframes stopGlowPulse {
  0% {
    text-shadow: 0 0 10px currentColor, 0 0 24px currentColor, 0 0 40px currentColor;
  }
  18% {
    text-shadow: 0 0 24px currentColor, 0 0 60px currentColor, 0 0 96px currentColor;
  }
  50% {
    text-shadow: 0 0 16px currentColor, 0 0 48px currentColor, 0 0 80px currentColor;
  }
  100% {
    text-shadow: 0 0 12px currentColor, 0 0 32px currentColor, 0 0 60px currentColor;
  }
}
